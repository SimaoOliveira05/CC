# --- ConfiguraÃ§Ã£o ---
# Apenas o IP da Nave MÃ£e Ã© variÃ¡vel. Default Ã© localhost.
MS_IP ?= 127.0.0.1

# --- Build ---
build:
	@echo "ğŸ› ï¸  A compilar..."
	go build -o bin/mothership ./cmd/mothership
	go build -o bin/rover ./cmd/rover

# --- Run ---

# make run-mothership
run-mothership:
	@echo "ğŸš€ Nave MÃ£e (IP Local / 0.0.0.0)"
	./bin/mothership

# make run-rover MS_IP=<IP_DA_NAVE_MAE>
run-rover:
	@echo "ğŸ¤– Rover a conectar a $(MS_IP)..."
	./bin/rover -ms-ip=$(MS_IP)

# make run-gc MS_IP=<IP_DA_NAVE_MAE>
run-gc:
	@echo "ğŸŒ Ground Control a conectar a http://$(MS_IP):8080..."
	cd ../ground-control && \
	VITE_API_URL="http://$(MS_IP):8080" \
	npm run dev

clean:
	rm -rf bin/
	rm -f *.log
	rm -f *_metrics.json

# --- Test Mode ---

# make test-mothership
test-mothership:
	@echo "ğŸ§ª Nave MÃ£e em modo de teste..."
	./bin/mothership -test-mode

# make test-rover MS_IP=<IP_DA_NAVE_MAE>
test-rover:
	@echo "ğŸ§ª Rover em modo de teste a conectar a $(MS_IP)..."
	./bin/rover -ms-ip=$(MS_IP) -test-mode